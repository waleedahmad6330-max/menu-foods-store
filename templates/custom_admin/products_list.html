{% extends 'store/base.html' %}

{% block content %}
<style>
    .admin-bg { background-color: #f8f9fa; min-height: 100vh; padding: 40px 0; }

    .manager-card {
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.04);
        overflow: hidden;
        border: none;
    }
    
    .table-header {
        background-color: #333;
        color: #fff;
        padding: 15px;
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 1px;
    }
    .table-header th { padding: 18px; border: none; font-weight: 600; }
    
    .table-row td {
        padding: 15px 18px;
        vertical-align: middle;
        border-bottom: 1px solid #f9f9f9;
        color: #555;
        font-size: 0.95rem;
    }
    .table-row:hover { background-color: #f9fffb; }

    .product-thumb {
        width: 60px; height: 60px;
        object-fit: cover;
        border-radius: 10px;
        border: 1px solid #eee;
        padding: 2px;
        background: #fff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .cat-badge {
        background-color: #e8f5e9;
        color: #006837;
        padding: 5px 12px;
        border-radius: 30px;
        font-size: 0.75rem;
        font-weight: 700;
        border: 1px solid #c8e6c9;
    }

    .btn-add-new {
        background-color: #006837;
        color: white;
        border: none;
        padding: 10px 25px;
        border-radius: 50px;
        font-weight: 600;
        transition: 0.3s;
        text-decoration: none;
        box-shadow: 0 5px 15px rgba(0, 104, 55, 0.2);
    }
    .btn-add-new:hover {
        background-color: #004d29;
        transform: translateY(-2px);
        color: white;
    }

    .action-btn {
        width: 35px; height: 35px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center; justify-content: center;
        transition: 0.2s;
        border: none;
        text-decoration: none;
    }
    .btn-edit { background-color: #e3f2fd; color: #1565c0; }
    .btn-edit:hover { background-color: #1565c0; color: white; }
    
    .btn-del { background-color: #ffebee; color: #c62828; }
    .btn-del:hover { background-color: #c62828; color: white; }
</style>

<div class="admin-bg">
    <div class="container">
        
        <div class="d-flex justify-content-between align-items-center mb-5">
            <div>
                <a href="{% url 'admin_dashboard' %}" class="text-decoration-none text-muted fw-bold small mb-1 d-block hover-link">
                    <i class="fas fa-arrow-left me-1"></i> Dashboard
                </a>
                <h2 class="fw-bold text-dark m-0">Manage Products</h2>
            </div>
            <a href="{% url 'admin_add_product' %}" class="btn-add-new">
                <i class="fas fa-plus me-2"></i> Add Product
            </a>
        </div>

        <div class="manager-card">
            <div class="table-responsive">
                <table class="table mb-0">
                    <thead class="table-header">
                        <tr>
                            <th class="ps-4">Image</th>
                            <th>Product Name</th>
                            <th>Price</th>
                            <th>Categories</th>
                            <th class="text-end pe-4">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for p in products %}
                        <tr class="table-row">
                            <td class="ps-4">
                                {% if p.image %}
                                <img src="{{ p.image.url }}" class="product-thumb" alt="{{ p.name }}">
                                {% else %}
                                <div class="product-thumb d-flex align-items-center justify-content-center bg-light text-muted">
                                    <i class="fas fa-image"></i>
                                </div>
                                {% endif %}
                            </td>
                            <td>
                                <span class="fw-bold text-dark d-block">{{ p.name }}</span>
                                <small class="text-muted">{{ p.description|truncatechars:40 }}</small>
                            </td>
                            <td class="fw-bold text-success">Rs. {{ p.price }}</td>
                            <td>
                                {% for c in p.categories.all %}
                                    <span class="cat-badge me-1">{{ c.name }}</span>
                                {% empty %}
                                    <span class="text-muted small">Uncategorized</span>
                                {% endfor %}
                            </td>
                            <td class="text-end pe-4">
                                <a href="{% url 'admin_edit_product' p.id %}" class="action-btn btn-edit me-2" title="Edit">
                                    <i class="fas fa-pen small"></i>
                                </a>
                                <a href="{% url 'admin_delete_product' p.id %}" class="action-btn btn-del" title="Delete" onclick="return confirm('Are you sure you want to delete {{ p.name }}?');">
                                    <i class="fas fa-trash small"></i>
                                </a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="text-center py-5 text-muted">
                                <i class="fas fa-box-open fa-3x mb-3 opacity-25"></i><br>
                                No products found. Start adding some!
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>
{% endblock %}